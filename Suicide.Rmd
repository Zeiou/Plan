---
title: "Socio and economic factors of suicide and spatial pattern in suicide rate"
author: "Yan Li 2446013L"
header-includes:
  - \usepackage{floatrow}
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{float}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage{makecell}
  - \usepackage{xcolor}
  - \floatsetup[table]{capposition=top}
  - \floatplacement{table}{H}
output: 
 pdf_document:
   latex_engine: pdflatex
   
   number_sections: yes
fig_caption: yes
bibliography: my5.bib
fontsize: 12pt
bookdown::pdf_book:
citation_package: none
csl: dharvard.csl
nocite: '@*'
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,eval = T,warning = F,message = F)

```

\newpage
\tableofcontents
\newpage
\pagenumbering{arabic}
# Chapter 1 - Introduction to the problem

## Introduction

Generally, the increase in suicide rate is related to age, whereas, its impact varies from country to country [@ageintro]. In addition to age, @sexintro pointed out that suicide rates of female are distinct from male's. Although the suicide risk for men is higher than women, @maleintro argued that men were more optimistic because they believed that suicide is avertable. Therefore, gender differences need to be considered when build models to reduce suicide rate.

Moreover, suicide behaviour between women and men is different. Men tend to choose more lethal modes which lead to higher fatality than women [@maleintro2]. One of the high-risk methods is firearms. Because of the distinctively high mortality rate from this type of suicide, firearms are taken into account. And globally, the mortality from firearms is extremely high in the United States, Brazil, Mexico, Colombia, and Venezuela [@firearmintro]. The deaths from suicide by firearm are impacted by the strength of laws and regulations controlling firearms in different countries. Due to the access to firearms is easier in the United States and South America, the suicide by firearm rates may appear clusters in this region.

Furthermore, the mental illnesses are associated with various negative outcomes, including suicide risk. @anxietyintro emphasized the importance of early anxiety disorders detection and treatment that contribute to lessening suicide risk. Additionally, suicide risk will also be generated by depression, which is the most common mental health problem among suicide people [@depressionintro]. Another social factor that affect suicide rate is alcohol consumption. @alcoholintro suggested that the regular part of clinical assessment in people with alcohol disorder should be screened for suicidality. And the suicide risk for people is relevant to their financial conditions. For example, suicide attempters are most likely to be unemployment [@unemploymentintro]. @GDPintro showed that there is an increasing trend of suicide rate before the economic crisis. Since neighbouring countries share more similar culture and social behaviour, they may also have similar suicide rate. For example, Islam prohibits alcohol consumption, which leads to its low prevalence in Muslim countries [@Islam]. Due to religious reasons, the suicide rate in these countries may be reduced by the low alcohol disorders rate. And suicide is still illegal in some countries, especially in East Africa [@suicideillegal]. Therefore, the suicide rate may appear clusters in the world. 

This work attempts to discover whether any clusters exist and to seek how these factors affect the suicide rate spatially. First is to analyse the suicidal differences between women and men by exploring the demographic data of suicide age and sex. Since men tend to use more lethal suicide methods. Apart from the data of age and sex, the suicide behaviour model also considers the effect of suicide by firearm. By regarding the mental issues and economic environment will also affect the suicide rate, the second model is to investigate how the social and economic factors affect the suicide rate, which includes the socio-economic and demographic variables. 

## Aims

This work is aimed to lower the suicide rate by seeking suicide risk factors.

The primary objective is to investigate suicide behaviour, including age, gender, and
firearm rate. And, the secondary objective is taking age and gender into consideration to examine the social and economic factors that include depression, anxiety disorders, alcohol consumption, unemployment rate, and GDP per capita.

## Description of data 

In this work, all data are from 2016 and all variables are continuous.

The response is the age-standardized suicide rates which are downloaded from the data set arranged by @owidsuicide. The age-standardized rate (ASR) is a fair comparison way between groups with different age distributions by adjusting the age differences in the population. And ASRs of suicide is the annual death totll from suicide per 100,000 people in each country. 
The demographic data and suicide behaviour variable are also organized by @owidsuicide. The demographic data including age-specific rates and sex-specific rates. They are the distributions of age and gender in each country, respectively. In the age-specific rates, there are 4 age groups, including aged from 5 to 14, aged from 15 to 49, aged from 50 to 69, and aged older than 70 years old. The suicide behaviour variable is age-standardized rates of firearm, which are death rates from suicide using firearms. 

The social effects are ASRs of depression, ASRs of anxiety disorders, and alcohol consumption per person in liters of pure alcohol aged older than 15 years old. This work harnesses the data that derives from @owidalcoholconsumption alcohol consumption data sets and the age-standardized mental data sets in @owidmentalhealth research. Additionally, economic effects show the economic differences among countries, which reflect on the unemployment rate and GDP per capita. The unemployment rate is the percentage of the labour force that is jobless but available to seek employment. With the succession of price changes and its differences between countries, the GDP per capita altered continuously. And the GDP per capita is measured with U.S. dollars in thousands of 2011 prices. The economic data sets are from @unemployment and @owideconomicgrowth.

The shapes of spatial plot is from Environmental Systems Research Institute (ESRI) and downloaded via online database [@world]. 


# Chapter 2 - Description of the methods

First, I mapped spatial data to see the distribution of the data in the world. Then, plotting the correlation matrix of suicide age and sex to explore their relationship. The plot showed a strong linear relationship between suicide age and sex of people older than 15 years old. As they are all important variables and cannot be removed. Therefore, I used the principal component analysis (PCA) to investigate their relationship and address the multicollinearity. From PCA, the first two principal components explained 92.2% of the variation, hence the first two principles have been chosen. The relationship between suicide age and sex was explored by the correlation circle in PCA. The first principal component is the average combination of suicide age and gender, and the second component is the suicide age difference between elderly women and under middle-age men. These two principal components represent the suicide age and sex of people older than 15 years old and are used to build the regression model. The response variable of regression model is the suicide rate. 

The first model is to investigate suicide behaviour. In this model, the explanatory variables are the first two principal components, suicide age from 5 to 14 years old, and suicide by firearms rate. First, the model assumptions were checked by residual plots. Then, the Moran’s I statistic test was used to determine whether the spatial autocorrelation in the residuals of the regression model is presence or not. From the test result, the residuals of suicide behaviour model presenced spatial autocorrelation. Hence, fit an extended model to data, which includes the same covariates as before and a set of spatially autocorrelated random effects. As the data is Gaussian distributed, the random effects are modelled by the conditional autoregressive (CAR) model proposed by @Leroux. After fitting the model, the Moran’s I statistic was carried out to determine the spatial patterns that have successfully been accounted for. Since the model was fit in a Bayesian setting using Markov chain Monte Carlo simulation, the convergence of the Markov chains was checked before making the inference. Finally, the map of the fitted values and the table of the estimated parameters were presented.

The second model is to examine how the social and economic factors influence the suicide rate. The explanatory variables of the socio-economic model are the first two principal components, depression, anxiety disorders, alcohol consumption, unemployment rate, and GDP per capita. As alcohol consumption is for people older than 15 years old, hence the suicide age from 5 to 14 years old is excluded. Similarly, I used the residual plots to check the model assumptions and Moran’s I statistic test to assess the spatial autocorrelation. Since the test result showed that the spatial autocorrelation is absent, and hence no need to fit an extended model. And, the tables of overall fit and estimated parameters were presented.


## Neighbourhood matrix

Although the suicide factors are different between countries, they may be more similar in neighboring countries due to similar culture. For example, the lifestyles in France and Italy are more similar than France and China. Hence, the sharing common border approach is suitable in neighbourhood matrix. However, some countries do not have any border with others and the distance between island countries are generally far. For example, the distance between Australia to New Zealand is much far away from Germany to France. Therefore, in this work, the neighbourhood matrix is an adapted version of the sharing common border approach which combines the common border approach and k-nearest neighbour method. Here, the neighbourhood matrix, $\mathbf{W}$, is defined as:
\begin{align}
{w}_{ij} =\left\{
\begin{array}{ll}
1 ~~~ \mbox{if the} ~ i^{th} \mbox{ country and } j^{th} \mbox{ country share a common border},\\
1 ~~~ \mbox{if the} ~ i^{th} \mbox{ country and } j^{th} \mbox{country are both island and nearest neighbour},\\
0 ~~~ \mbox{Otherwise},
\end{array}
\right.
\end{align}
where $w_{..}=\sum_{i}\sum_{j}{w}_{ij}$ and $n=154$. In this work, the choice of K value is one and the symmetry of W matrix is ensured (${w}_{ij}={w}_{ji}$) to address the drawback of k-nearest neighbour method.

## Moran’s I statistic

The most common way to check the residuals of the model for the presence of spatial autocorrelation is Moran’s I statistic, which is developed by @Moran. Consider data $\mathbf{z}=({z}_{1},...,{z}_{n})$ relating to a set of $n$ areal units, and a corresponding $n \times n$ binary neighbourhood matrix $\mathbf{W}$, the Moran's I statistic is defined as:
\begin{align}
I = \frac{n\sum_{i=1}^{n}\sum_{j=1}^{n} {w}_{ij}({z}_{i}-\overline{z})({z}_{j}-\overline{z})}{w_{..}\sum_{i=1}^{n} ({z}_{i}-\overline{z})^{2}}.
\end{align}
The hypotheses for the permutation test, which is used to assess the significance of the spatial autocorrelation are:
$${H}_{0}: \mbox{There is no spatial association}$$
$${H}_{1}: \mbox{There is some spatial association}$$
The estimated p-value for the test is 
\begin{align}
p=\frac{1}{K+1}\sum^{K}_{k=1}I(I_k>I_{obs}),
\end{align}
where $I_{obs}$ is the observed Moran's I test statistic and $I_1,...,I_k$ is Moran's I statistic for $K$ different random permutations of the data.


## Leroux CAR model

When an important spatially autocorrelated covariate is unmeasured, the residuals will present spatial autocorrelation. And it will induces spatial autocorrelation into the response. The most common remedy is to add a set of spatially autocorrelated random effects into the linear predictor, as part of a Bayesian hierarchical model. The random effects are represented with a conditional autoregressive prior, which induces spatial autocorrelation through the neighbourhood structure of the areal units [@CARBayes]. In this work, the data is Gaussian distributed, hence use the Leroux CAR model. The Leroux CAR model are proposed by @Leroux, which only using a single set of random effects. The model of random effects $\phi_{i}$ is given by
\begin{align}
\begin{aligned}
\phi|\phi_{-i},\mathbf{W},\tau^{2},\rho &\sim \mbox{N}(\frac{\rho\sum_{j=1}^{n}w_{ij}\phi_{j}}{\rho\sum_{j=1}^{n}w_{ij}+1-\rho},\frac{\tau^{2}}{\rho \sum_{j=1}^{n}w_{ij}+1-\rho}) \\
\tau^{2} &\sim\mbox{Inverse-Gamma}(a,b) \\
\rho &\sim\mbox{Uniform}(0,1),
\end{aligned}
\end{align}
where $\rho$ is a spatial autocorrelation parameter, with $\rho=1$ corresponding to strong spatial autocorrelation, while $\rho=0$ corresponds to independence. And the neighbourhood matrix, $\mathbf{W}$, is given by the equation 1. 

# Chapter 3 - Analysis of the data

## Exploratory data analysis

```{r library}

library(dplyr)
library(tidyr)
library(ggplot2)
library(moderndive)
library(sp) 
library(rgdal)
library(rgeos) 
library(maptools) 
library(RColorBrewer) 
library(spdep)
library(CARBayes) 
library(knitr)
library(kableExtra)
library(gridExtra)
library(GGally)
library(FactoMineR)
library(factoextra)
library(xtable)
```


```{r data}
suicide_death_rates<-read.csv("deathrates.csv",header = T)
suicide_death_rates_by_sex<-read.csv("deathrates_sex.csv",header = T)
suicide_death_rates_by_age<-read.csv("deathrates_age.csv",header = T)
suicide_death_rates_by_firearm<-read.csv("deathrates_firearm.csv",header = T)
depression_all<-read.csv("depression.csv",header = T)
anxiety_all<-read.csv("anxiety_disorders.csv",header = T)
unemployment_rate<-read.csv("unemployment_rate.csv",header = T)
gdp_per_capita<-read.csv("maddison-data-gdp-per-capita-in-2011us.csv",header = T)
alchol_all<-read.csv("total-alcohol-consumption-per-capita-litres-of-pure-alcohol.csv",header = T)
```

```{r data2016}

deathrates<-suicide_death_rates%>%
  filter(Year==2016)%>%
  dplyr::select(Entity,Deaths...Self.harm...Sex..Both...Age..Age.standardized..Rate...deaths.per.100.000.individuals. )%>%
  rename(ASR=Deaths...Self.harm...Sex..Both...Age..Age.standardized..Rate...deaths.per.100.000.individuals.)

age<-suicide_death_rates_by_age%>%
  filter(Year==2016)%>%
  dplyr::select(Entity,over.70.years..deaths.per.100.000.,X50.to.69.years..deaths.per.100.000.,X15.to.49.years..deaths.per.100.000.,X5.to.14.years..deaths.per.100.000.)%>%
  rename(age70older=over.70.years..deaths.per.100.000., age50to69=X50.to.69.years..deaths.per.100.000., age15to49=X15.to.49.years..deaths.per.100.000.,
age5to14=X5.to.14.years..deaths.per.100.000.)


sex<-suicide_death_rates_by_sex%>%
  filter(Year==2016)%>%
  dplyr::select(Entity,Female..deaths.per.100.000.,Male..deaths.per.100.000.)%>%
  rename(female=Female..deaths.per.100.000.,male=Male..deaths.per.100.000.)

firearm<-suicide_death_rates_by_firearm%>%
  filter(Year==2016)%>%
  dplyr::select(Entity,Deaths...Self.harm.by.firearm...Sex..Both...Age..Age.standardized..Rate...deaths.per.100.000.)%>%
  rename(firearm=Deaths...Self.harm.by.firearm...Sex..Both...Age..Age.standardized..Rate...deaths.per.100.000.)

depression<-depression_all%>%
  filter(Year==2016)%>%
dplyr::select(Entity,Prevalence...Depressive.disorders...Sex..Both...Age..Age.standardized..Percent.....)%>%
  rename(depression=Prevalence...Depressive.disorders...Sex..Both...Age..Age.standardized..Percent.....)

anxiety<-anxiety_all%>%
  filter(Year==2016)%>%
dplyr::select(Entity,Prevalence...Anxiety.disorders...Sex..Both...Age..Age.standardized..Percent.....)%>%
  rename(anxiety=Prevalence...Anxiety.disorders...Sex..Both...Age..Age.standardized..Percent.....)

unemployment<-unemployment_rate%>%
  filter(Year==2016)%>%
  dplyr::select(Entity,Unemployment..total....of.total.labor.force...modeled.ILO.estimate.....of.total.labor.force.)%>%
  rename(unemployment=Unemployment..total....of.total.labor.force...modeled.ILO.estimate.....of.total.labor.force.)

GDP_percapita<-gdp_per_capita%>%
  filter(Year==2016)%>%
  dplyr::select(Entity,GDP.per.capita..int........)%>%
  rename(GDP=GDP.per.capita..int........)%>%
  mutate(GDP=GDP/1000)

alchol<-alchol_all%>%
  dplyr::select(Entity,Alcohol.consumption..litres.per.capita...liters.of.pure.alcohol..projected.estimates..15..years.of.age.)%>%
  rename(alcohol=Alcohol.consumption..litres.per.capita...liters.of.pure.alcohol..projected.estimates..15..years.of.age.)



suicide_2016<-deathrates%>%
  inner_join(age,by="Entity")%>%
  inner_join(sex,by="Entity")%>%
  inner_join(firearm,by="Entity")%>%
  inner_join(depression,by="Entity")%>%
  inner_join(anxiety,by="Entity")%>%
  inner_join(alchol,by="Entity")%>%
  inner_join(unemployment,by="Entity")%>%
  inner_join(GDP_percapita,by="Entity")

suicide_2016$Entity[grepl('Democratic Republic of Congo', suicide_2016$Entity)]<-'Democratic Republic of the Congo'
suicide_2016$Entity[grepl('Puerto Rico', suicide_2016$Entity)]<-'Puerto Rico (US)'

#sum(is.na(suicide_2016)) 

suicide_2016$sexratio<-suicide_2016$male/suicide_2016$female

world <- readOGR(dsn = "World_Countries.shp",verbose=FALSE)
world <- spTransform(world, CRS("+proj=longlat +datum=WGS84 +no_defs"))
world.dat <- merge(world, suicide_2016, all.x=FALSE, by.x="COUNTRY", by.y="Entity") 
world.dat@data$id <- rownames(world.dat@data) 
temp1 <- fortify(world.dat, region = "id") 
world.dat2 <- merge(temp1, world.dat@data, by = "id") 


#suicide_2016[which(!(suicide_2016$Entity%in%world.dat2$COUNTRY)),]$Entity

suicide_2016<-suicide_2016[-which(!(suicide_2016$Entity%in%world.dat2$COUNTRY)),]
```

In total, there are `r nrow(suicide_2016)` countries data with zero missing value. 

Globally, the age-standardized rates (ASRs) of suicide in 2016 is `r round(mean(suicide_2016$ASR),2) `. It means around `r round(mean(suicide_2016$ASR),0) ` people per 100,000 died from suicide in 2016. The highest suicide rates is in `r suicide_2016[which.max(suicide_2016$ASR),]$Entity`, an enclaved country within the border of South Africa, around `r round(suicide_2016[which.max(suicide_2016$ASR),]$ASR,0)` people per 100,000 died from suicide in 2016. The lowest suicide rates is in `r suicide_2016[which.min(suicide_2016$ASR),]$Entity`, a middle east country, only `r round(suicide_2016[which.min(suicide_2016$ASR),]$ASR)` people per 100,000 died from suicide. And the suicide rates in Eastern Europe (`r round(deathrates[deathrates$Entity=="Eastern Europe",]$ASR,2)`) is approximately three times larger than that in Western Europe (`r round(deathrates[deathrates$Entity=="Western Europe",]$ASR,2)`). 

Across the world, the suicide rate for male is `r round(mean(suicide_2016[,8]),2)` which is `r round(mean(suicide_2016[,15]),2)` times higher than that for female (`r round(mean(suicide_2016[,7]),2)`). The highest male-to-female ratio of suicide is in `r suicide_2016[which.max(suicide_2016$sexratio),]$Entity` (`r round(suicide_2016[which.max(suicide_2016$sexratio),]$sexratio,2)`) and the lowest is in `r suicide_2016[which.min(suicide_2016$sexratio),]$Entity` (`r round(suicide_2016[which.min(suicide_2016$sexratio),]$sexratio,2)`). The latter is the only country that the suicide rate for female is higher than male.

Overall, the highest average suicide rate is from elderly people aged older than 70 years old (`r round(mean(suicide_2016[,3]),2)`)  and the lowest is from children aged 5 to 14 (`r round(mean(suicide_2016[,6]),2)`). For kids, the highest suicide rate is in `r suicide_2016[which.max(suicide_2016[,6]),]$Entity`, a developing country in East Asia, where around `r round(suicide_2016[which.max(suicide_2016[,6]),]$age5to14)` people per 100,000 died from suicide. And, for elderly people, the highest suicide rate is in `r suicide_2016[which.max(suicide_2016[,3]),]$Entity`, a developed country in East Asia, where around `r round(suicide_2016[which.max(suicide_2016[,3]),]$age70older)` people per 100,000 died from suicide. 

Furthermore, the suicide risk factors are also distinct between counties. For example, the highest suicide by firearm rate is in the `r suicide_2016[which.max(suicide_2016$firearm),]$Entity`, which is `r round(suicide_2016[which.max(suicide_2016$firearm),]$firearm)/round(suicide_2016[which.min(suicide_2016$firearm),]$firearm,2)` times higher than the lowest firearm rate country, `r suicide_2016[which.min(suicide_2016$firearm),]$Entity`. 

In short, the suicide demographic structure and risk factors are different between countries. Therefore, the following is mapping the spatial data to see how these data distributed in the world. 

### Mapping data

```{r ASRs,fig.height=2.2, fig.width=4.5, fig.align = "center",fig.cap = "\\label{ } ASRs of suicide in 2016.", fig.pos ='H'}
ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill = ASR)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "ASRs of suicide", fill = "ASRs") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

```

The fig \ref{fig:ASRs} shows the age-standardized rates (ASRs) of suicide are higher in Eastern Europe and Central Asia. Generally, the ASRs of suicide of North America are higher than Latin America. And the ASRs of suicide increase from north to south in Latin America. In Africa, the ASRs of suicide are much higher in neighbouring countries of South Africa than others. And the lowest ASRs of suicide appear in Southeast Asia.

```{r sex_ratio,fig.height=2.2, fig.width=4.5, fig.align = "center",fig.cap = "\\label{ } Male-to-female ratio of suicide in 2016.", fig.pos ='H'}

ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill = sexratio)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "Male-to-female ratio of suicide rate", fill = "Ratio") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))


```

The fig \ref{fig:sex_ratio} shows that the suicide risk for men is higher in Eastern Europe, Central Asia, and Latin America countries than others in the world. From Central Asia to East Asia, the male-to-female ratio of suicide seems to drop dramatically and then slightly increase from East Asia to Southeast Asia. In West Africa, the sex ratio of `r suicide_2016[which.max(suicide_2016$sexratio),]$Entity` is extremely higher than other countries. 


```{r age,fig.height=5, fig.width=10, fig.align = "center",fig.cap = "\\label{fig:box} Age-specific rates of suicide in 2016.", fig.pos ='H'}


plot1<- ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill =age70older)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "Aged 70+ years", fill = "Suicide rate") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

plot2<- ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill =age50to69)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "Aged 50 to 69 years", fill = "Suicide rate") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))


plot3<- ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill =age15to49)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "Aged 15 to 49 years", fill = "Suicide rate") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

plot4<- ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill =age5to14)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "Aged 5 to 14 years", fill = "Suicide rate") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

grid.arrange(plot1, plot2, plot3, plot4,ncol=2, nrow=2)
```

The fig \ref{fig:age} shows that in the suicide rate of people older than 70 years old is very high in East African and West Africa. In Eastern Europe and Central Asia, the suicide rate of people aged from 15 to 69 years old is higher than in other regions. For kids, the suicide rate is lower in Africa than others and very high in Mongolia and Central Asia. 


```{r firearm,fig.height=2.2, fig.width=4.5, fig.align = "center",fig.cap = "\\label{ } ASRs of suicide by firearm in 2016.", fig.pos ='H'}
ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill = firearm)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "ASRs of suicide by firearm", fill = "Firearm rate") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

```

The fig \ref{fig:firearm} shows that the firearm rates increase dramatically from South America to North America, especially in the  `r suicide_2016[which.max(suicide_2016$firearm),]$Entity` where around `r round(suicide_2016[which.max(suicide_2016$firearm),]$firearm)` people per 100,000 died from suicide by firearms in 2016. Conversely, the firearm rates drop dramatically from Central Asia to Southeast Asia. 

```{r mental,fig.height=5, fig.width=10, fig.align = "center",fig.cap = "\\label{fig:box} Mental health and alcohol consumption in 2016.", fig.pos ='H'}


mental1<- ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill =depression)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "ASRs of depression", fill = "ASRs") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

mental2<- ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill =anxiety)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "ASRs of anxiety disorders", fill = "ASRs") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))


alchol_plot<- ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill =alcohol)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "Alcohol consumption per capita", fill = "Liters") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

layout_matrix <- matrix(c(1, 1, 2, 2, 4, 3, 3, 4), nrow = 2, byrow = TRUE)

grid.arrange(mental1,mental2,alchol_plot,layout_matrix=layout_matrix)

```

The fig \ref{fig:mental} shows that the global distribution of depression and anxiety disorders is quite different. People in Asia, Africa (except North Africa), and most countries in East Europe tend to get depression more easily than anxiety disorders. However, people in Latin America, the risk of getting anxiety disorders is higher than depression. Comparing the mapping of alcohol consumption (the bottom figure) and the above two figures of mental health, it is easy to see that alcohol consumption is more related to depression than anxiety disorders. Except for North Africa and the Middle East, one of the possible reasons for that is religion. 

```{r economic,fig.height=2.5, fig.width=9, fig.align = "center",fig.cap = "\\label{} Unemployment rate and GDP per capita in 2016.", fig.pos ='H'}

unemployment_plot<- ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill=unemployment)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "Unemployment rate", fill = "Rate") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

GDP_plot<- ggplot(data = world.dat2, aes(x=long, y=lat, goup=group, fill=GDP)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "GDP per capita", fill = "$1000 ") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

grid.arrange(unemployment_plot,GDP_plot,nrow=1)

```

The fig \ref{fig:economic} shows that the unemployment rate is higher in Africa and Latin America than other regions. In North America and Latin America, the unemployment rate increasing with the GDP per capita decreasing. However, the highest unemployment rate appears in South Africa where the GDP per capita is slightly higher than North and West Africa. Although the GDP per capita of developing countries in Asia is much lower than developed countries in North America, the unemployment rate seems very similar. 


### Corrleation of demographic data

The fig \ref{fig:sex_ratio} and fig \ref{fig:age} shows the distribution of suicide age and sex ratio is various in each country, which suggests the suicide rate is affected by the demographic structure. Therefore, it is reasonable to use the correlation matrix to explore the relationship between suicide age and sex.

```{r corplot1, out.width="60%", fig.align = "center",fig.cap = "\\label { } Correlation of sex and age.", fig.pos ='H'}

ggcorr(world.dat@data[,c(8:3)], label=TRUE, label_size=5, label_color='white',low = "#fee6ce", mid = "#fde0dd", high = "#de2d26")

```
From the fig \ref{fig:corplot1}, there is a very strong positive relationship appears between men and suicide age from 15 to 69 years old. Whereas, women only have a very strong positive relationship with age from 50 to 69 years old. The correlation coefficient between elderly people and women is slightly higher than that of men. However, the suicidal thoughts of children from 5 to 14 years old only have a very weak relationship with gender.


### Principal component analysis

Due to the strong correlated relationship between age and gender shows in the fig \ref{fig:corplot1}, the multiple linear regression will arise the issue of multicollinearity. Because age and sex are both important variables and cannot be removed, this work uses the principal component analysis (PCA) to address the multicollinearity. Furthermore, the original data of age have been classified into four groups and the suicide age of women and men seems different in fig \ref{fig:corplot1}, which can be investigated by PCA. Here, analyse the suicide age and sex of people older than 15 years old with PCA first before modelling it.  

```{r PCA1,out.width = "50%", fig.align = "center",fig.cap = "\\label { } Scree plot.", fig.pos ='H'}

suicide.pca<-princomp(world.dat@data[,c(3:5,7:8)], cor=T) 

fviz_eig(suicide.pca,addlabels = TRUE)
```
The fig \ref{fig:PCA1} shows that the first principal component explains 75.1% of the variation and the second one explains 17.1%. In total, the first two principal components explain 92.2% of the variation, and it is larger than 80%. Hence, choose the first two principal components.

```{r PCA2,out.width = "53%", fig.align = "center",fig.cap = "\\label { } Correlation circle.", fig.pos ='H'}

fviz_pca_var(suicide.pca, col.var = "black")

```
The fig \ref{fig:PCA2} shows that the observation seems to grouped by sex. Women seem to have a strong positive correlation with age from 50 to 69 and men seem to have more correlated with age from 15 to 49 years old than older than 50 years old. In General, the suicide age for women is older than men. 


```{r load_tab}

l<-suicide.pca$loadings

Comp.1<-c(l[1:5])
Comp.2<-c(l[6:10])

rowname<-c("age70older","age50to69","age15to49","female","male")

load<-data.frame(Comp.1,Comp.2,row.names = rowname)


load%>%
kable(
    digits = 3,
    caption = "Loadings of first two principal components",
    booktabs = TRUE)%>%
kable_styling(font_size = 11,latex_options = "HOLD_position",full_width = F)
``` 

Table \ref{tab:load_tab} shows that the component loadings for the first principal component all have the same sign and are roughly equal in magnitude, which can be interpreted as the average of suicide age and gender. Since the loadings of "age70older" and "age15to49" dominate the second component and have different signs. The second component can be interpreted as the difference between elderly females and under middle-age males.


## Analyses and model checks

### Investigate the suicide behaviour

From PCA, the first principal component is the average suicide age and gender of people older than 15 years old and the second principal component is the suicide rate difference between older than 70 years old women and aged from 15 to 49 years old men. As they are the combination of age and sex of people older than 15 years old and explain 92.2% of the variation, it is sensible to use them to build the multiple linear regression model. In this model, the demographic variables are the first two principal components from PCA and the suicide rate of children from 5 to 14 years old. Since the suicide methods of men are more lethal than women, this work takes the firearm rate as the suicide behaviour factors. The regression model is given as:
\begin{align}
{\mbox{ASR}_i}={\alpha} + {\beta}_{1} \cdot {\mbox{PC1}_i} + {\beta}_{2} \cdot {\mbox{PC2}_i} + {\beta}_{3} \cdot {\mbox{age5to14}_i} + {\beta}_{4} \cdot {\mbox{firearm}_i} + \epsilon_i, ~~ \epsilon_i \sim N(0, \sigma^2)
\end{align}
where

- ${\mbox{ASR}_i}$ is the age-standardized suicide rate of the $i^{th}$ country;

- ${\mbox{PC1}_i}$ is the average suicide age and sex of people older than 15 years old in the $i^{th}$ country;

- ${\mbox{PC2}_i}$ is the suicide rate difference between older than 70 years old women and aged from 15 to 49 years old men in the $i^{th}$ country;

- ${\mbox{age5to14}_i}$ is the suicide rate of children from 5 to 14 years old in the $i^{th}$ country;

- ${\mbox{firearm}_i}$ is the suicide rate involving firearms in $i^{th}$ country; and

- $\epsilon_i$ is the $i^{th}$ random error component.

```{r }
suicide.pca.reg<-data.frame(COUNTRY=world.dat@data$COUNTRY,ASR=world.dat@data$ASR ,PC1=suicide.pca$scores[, 1],PC2=suicide.pca$scores[, 2],age5to14=world.dat@data$age5to14,firearm=world.dat@data$firearm)

m1<-lm(ASR~PC1+PC2+age5to14+firearm,data=suicide.pca.reg)
```

First, check the assumptions of multiple regression model by residual plots.

```{r check1, fig.height=2.3, fig.width=7, fig.align = "center",fig.cap = "\\label{ } Assessing suicide data model fit.", fig.pos ='H'}


regression.points1<-get_regression_points(m1)


check1<-ggplot(regression.points1,aes(x=ASR_hat,y =residual))+
  geom_point()+
  labs(x ="Fitted value",y ="Residual",title = "Residuals against fitted values")+
  geom_hline(yintercept =0,col ="blue",size =1)


check2<-ggplot(regression.points1,aes(x =residual))+
  geom_histogram(binwidth =0.25,color ="white")+
  labs(x ="Residual",title = "Histograms of residuals")

grid.arrange(check1,check2,nrow=1)

```
From the fig \ref{fig:check1}, the residuals appear to be randomly distributed above and below the zero line from the scatter plot. Therefore, the zero mean and constant variance  assumption seems to be valid. And the histogram shows that the residuals appear to be normally distributed. Hence, the residuals of the regression model satisfy the assumptions of normally distributed with zero mean and constant variance.

Then, assess the presence of spatial autocorrelation in the residuals by Moran’s I statistic test. 

```{r }
world.dat.suicide.factor<-merge(world, suicide.pca.reg, all.x=FALSE, by.x="COUNTRY", by.y="COUNTRY") 


world.dat.suicide.factor@data$id <- rownames(world.dat@data) 
temp2 <- fortify(world.dat.suicide.factor, region = "id") 
world.dat2.suicide.factor <- merge(temp2, world.dat.suicide.factor@data, by = "id")
W.nb <- poly2nb(world.dat.suicide.factor,row.names = world.dat.suicide.factor@data$id)
W.list <- nb2listw(W.nb, style = "B",zero.policy = T)
#print(W.list,zero.policy = T)
#summary(W.list,zero.policy = T)

wds<-world.dat.suicide.factor[world.dat.suicide.factor@data$id %in% c(7,10,12,130,32, 26,36,61,70,69,128,85,91,89,102,112,124,139,119,63),]

wds.suicide.factor <- merge(temp2, wds@data, by = "id")
wds.1nn<-knearneigh(coordinates(wds),k=1,longlat = T)
wds.1nn.nb<-knn2nb(wds.1nn,row.names = wds@data$id)
wds.1nn.nb<-make.sym.nb((wds.1nn.nb))

wds.1nn.list <- nb2listw(wds.1nn.nb, style = "B",zero.policy = T) 
#print(wds.1nn.list,zero.policy = T)
#summary(wds.1nn.list,zero.policy = T)

x<-data.frame(c(7,10,12,130,32,26,36,61,70,69,128,85,91,89,102,112,124,139,119,63))

for (i in 1:20) {
  wds.1nn.nb[[i]]<-as.integer(x[unlist(wds.1nn.nb[[i]]),])
}



W.nb[[8]]<-integer(length =2L)
W.nb[[36]]<-integer(length =2L)
W.nb[[85]]<-integer(length =2L)
W.nb[[94]]<-integer(length =2L)
W.nb[[124]]<-integer(length =2L)
W.nb[[131]]<-integer(length =2L)
W.nb[[154]]<-integer(length =3L)

W.nb[[8]]<-wds.1nn.nb[[1]]
W.nb[[36]]<-wds.1nn.nb[[7]]
W.nb[[85]]<-wds.1nn.nb[[12]]
W.nb[[94]]<-wds.1nn.nb[[14]]
W.nb[[124]]<-wds.1nn.nb[[17]]
W.nb[[131]]<-wds.1nn.nb[[18]]
W.nb[[154]]<-wds.1nn.nb[[20]]

x2<-data.frame(which(W.list[[2]]%in%0))

for (i in c(2:6,8:11,13,15,16,19)) {
  W.nb[x2[i,]]<- wds.1nn.nb[[i]]
}


W.nb<-make.sym.nb((W.nb))
W.list <- nb2listw(W.nb, style = "B",zero.policy = T)

W<-nb2mat(W.nb, style = "B") 

```

```{r  eval=FALSE}
moran.mc(x = residuals(m1), listw = W.list, nsim = 10000) 
```


```{r moran, results = 'asis',echo=FALSE}

options(xtable.floating = TRUE,
        xtable.include.rownames = FALSE,
        xtable.comment = FALSE,
        xtable.booktabs = TRUE)

moran1<- xtable(
    data.frame(
    simulations = c(10001),
    statistic  = c(0.33312),
    "observed rank"  = c(10001),
    "p-value"  = c(9.999e-05)),
  caption = "Monte-Carlo simulation of Moran I",
  digits = c(3,3,3,3,3))

print.xtable(moran1)

```
Since the p-value in table 2 is less than 0.05, the spatial autocorrelation is present and hence needs to be modelled. The extended model is given by
\begin{align}
\begin{aligned}
\mbox{ASR}_i &\sim \mbox{N}(\mu_{i},\sigma^{2})~~~~\mbox{for } i=1,...,n \\
\mu_{i} &= {\alpha} + {\beta}_{1} \cdot {\mbox{PC1}_i} + {\beta}_{2} \cdot {\mbox{PC2}_i} + {\beta}_{3} \cdot {\mbox{age5to14}_i} + {\beta}_{4} \cdot {\mbox{firearm}_i} +\phi_{i}. \\
\end{aligned}
\end{align}
The random effects, $\phi_{i}$, is modelled by the Leroux CAR model which is given by
\begin{align}
\begin{aligned}
\phi|\phi_{-i},\mathbf{W},\tau^{2},\rho &\sim \mbox{N}(\frac{\rho\sum_{j=1}^{n}w_{ij}\phi_{j}}{\rho\sum_{j=1}^{n}w_{ij}+1-\rho},\frac{\tau^{2}}{\rho\sum_{j=1}^{n}w_{ij}+1-\rho}) \\
\tau^{2} &\sim\mbox{Inverse-Gamma}(a,b) \\
\rho &\sim\mbox{Uniform}(0,1),\\
\end{aligned}
\end{align}
where the neighbourhood matrix, $\mathbf{W}$, is given by the equation 1. 

```{r mode3}
mode3 <- S.CARleroux(formula=ASR~PC1+PC2+age5to14+firearm , family="gaussian", data=world.dat.suicide.factor@data, W=W, burnin=20000, n.sample=120000, thin=10, verbose=FALSE) 
```

Since the model was fit in a Bayesian setting using Markov chain Monte Carlo simulation, the convergence of the Markov chains was checked before making the inference. And the Moran's I statistic was carried out to determine whether the spatial patterns have successfully been accounted for.

```{r  eval=FALSE}
moran.mc(x = residuals(mode3), listw = W.list, nsim = 10000) 
```

```{r moran3, results = 'asis',echo=FALSE}

options(xtable.floating = TRUE,
        xtable.include.rownames = FALSE,
        xtable.comment = FALSE,
        xtable.booktabs = TRUE)

moran3<- xtable(
    data.frame(
    simulations = c(10001),
    statistic  = c(-0.046762),
    "observed rank"  = c(2401),
    "p-value"  = c(0.7599)),
  caption = "Monte-Carlo simulation of Moran I",
  digits = c(3,3,3,3,3))

print.xtable(moran3)

```

```{r mode3check, fig.height=3, fig.width=7, fig.align = "center",fig.cap = "\\label{fig:box} Checking convergence of the MCMC simulation.", fig.pos ='H'}

plot(mode3$samples$rho)

```
Since the p-value in table 3 is greater than 0.05, hence the spatial autocorrelation is absent now. In the fig \ref{fig:mode3check}, the left plot shows no trend and hence convergence. And the right plot shows the estimated value of $\rho$ is closed to 0.9, suggesting the spatial dependence in suicide data after adjusting for the covariates is very strong.

### Investigate the social and economic factors

The secondary objective is taking age and gender into consideration to investigate the social and economic factors, including depression, anxiety disorders, alcohol consumption, unemployment rate, and GDP per capita. Since the alcohol consumption is pure alcohol in liters of people aged older than 15 years old. Hence, data of children from 5 to 14 years old would not be considered in this model. For demographic variables, using the first two principal components from PCA as they combine the age and sex of people older than 15 years old and explain 92.2% of the variation. The first principal component is the average suicide age and gender of people older than 15 years old and the second principal component is the difference between elderly women and under middle-age men. Taking the first two principal components into account to analyse the influence of social and economic factors on suicide. The multiple regression is given by
\begin{align}
\begin{aligned}
\mbox{ln}(\mbox{ASR}_i) = &\ {\alpha} + {\beta}_{1} \cdot {\mbox{PC1}_i} + {\beta}_{2} \cdot {\mbox{PC2}_i} + {\beta}_{3} \cdot {\mbox{depression}_i} + {\beta}_{4} \cdot {\mbox{anxiety}_i} \\ + &\ {\beta}_{5} \cdot {\mbox{alcohol}_i}  +  {\beta}_{6} \cdot {\mbox{unemployment}_i} + {\beta}_{7} \cdot {\mbox{GDP}_i} + \epsilon_i,~~\epsilon_i \sim N(0, \sigma^2) 
\end{aligned}
\end{align}
where

- ${\mbox{ASR}_i}$ is the age-standardized suicide rate of the $i^{th}$ country;

- ${\mbox{PC1}_i}$ is the average suicide age and sex of people older than 15 years old in the $i^{th}$ country;

- ${\mbox{PC2}_i}$ is the suicide rate difference between older than 70 years old women and aged from 15 to 49 years old men in the $i^{th}$ country;

- ${\mbox{depression}_i}$ is the age-standardized depression rate in the $i^{th}$ country;

- ${\mbox{anxiety}_i}$ is the age-standardized anxiety disorders rate in the $i^{th}$ country;

- ${\mbox{alcohol}_i}$ is alcohol consumption per person in liters of pure alcohol aged older than 15 years old in the $i^{th}$ country;

- ${\mbox{unemployment}_i}$ is the unemployment rate in $i^{th}$ country; 

- ${\mbox{GDP}_i}$ is the GDP per capita of $i^{th}$ country; and

- $\epsilon_i$ is the $i^{th}$ random error component.

```{r }

suicide_2016$log_ASR<-log(suicide_2016$ASR)
suicide_2016$PC1<-suicide.pca.reg$PC1

suicide_2016$PC2<-suicide.pca.reg$PC2

m2<-lm(log_ASR~PC1+PC2+depression+anxiety+alcohol+unemployment+GDP,data=suicide_2016)

```

First, check the assumptions of multiple regression model by residual plots.

```{r check2, fig.height=2.3, fig.width=7, fig.align = "center",fig.cap = "\\label{ } Assessing social and economic effects data model fit.", fig.pos ='H'}


regression.points2<-get_regression_points(m2)


check21<-ggplot(regression.points2,aes(x=log_ASR_hat,y =residual))+
  geom_point()+
  labs(x ="Fitted value",y ="Residual",title = "Residuals against fitted values")+
  geom_hline(yintercept =0,col ="blue",size =1)


check22<-ggplot(regression.points2,aes(x =residual))+
  geom_histogram(binwidth =0.25,color ="white")+
  labs(x ="Residual",title = "Histograms of residuals")

grid.arrange(check21,check22,nrow=1)



```

From fig \ref{fig:check2}, the residuals in scatter plot appear to be randomly distributed above and below the zero line and hence the zero mean and constant variance assumption seems to be valid. And the residuals appear to be a bell-shaped in the histogram. Therefore, the residuals of the regression model satisfy the assumptions of normally distributed with zero mean and constant variance.

Then, assess the presence of spatial autocorrelation in the residuals by Moran’s I statistic test.

```{r eval=FALSE}

moran.mc(x = residuals(m2), listw = W.list, nsim = 10000)

```

```{r moran2, results = 'asis',echo=FALSE}

options(xtable.floating = TRUE,
        xtable.include.rownames = FALSE,
        xtable.comment = FALSE,
        xtable.booktabs = TRUE)

moran2<- xtable(
    data.frame(
    simulations = c(10001),
    statistic  = c(0.00044113),
    "observed rank"  = c(5608),
    "p-value"  = c(0.4393)),
  caption = "Monte-Carlo simulation of Moran I",
  digits = c(3,3,3,3,3))

print.xtable(moran2,table.placement = "H")


```

Since the p-value in table 4 is greater than 0.05, the spatial autocorrelation is absent and hence there is no need to be modelled. 


## Interpretations of analyses

### Suicide behaviour model

```{r real_fit,fig.height=2.3, fig.width=9, fig.align = "center",fig.cap = "\\label{ } Compare ASRs of sucide with the fitted value.", fig.pos ='H'}

world.dat.suicide.factor@data$fitted<-mode3$fitted.values
world.dat.suicide.factor@data$id <- rownames(world.dat@data) 
temp2 <- fortify(world.dat.suicide.factor, region = "id") 
world.dat2.suicide.factor <- merge(temp2, world.dat.suicide.factor@data, by = "id")

real<-ggplot(data = world.dat2.suicide.factor, aes(x=long, y=lat, goup=group, fill = ASR)) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "ASRs of suicide in 2016", fill = "ASRs") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

fit<-ggplot(data = world.dat2.suicide.factor , aes(x=long, y=lat, goup=group, fill = fitted )) +
  geom_polygon() + 
  xlab("Longitude") + 
  ylab("Latitude") + 
  labs(title = "Fitted value", fill = "ASRs") + 
  theme(title = element_text(size=10)) + 
  scale_fill_gradientn(colors=brewer.pal(n=9, name="Reds"))

grid.arrange(real,fit,nrow=1)

```

The fig \ref{fig:real_fit} shows that the fitted value is very closed to the real value and hence the predictive performance of the model is very well. Following, the estimated parameters of Leroux CAR model are showed in table 5.

```{r mode3 summary,eval=FALSE}
print(mode3)
summary(mode3) 
summary(mode3$samples)
```

```{r mode3 estimated, results = 'asis',echo=FALSE}

# Preset some options for printing your xtables
options(xtable.floating = TRUE,
        xtable.include.rownames = FALSE,
        xtable.comment = FALSE,
        xtable.booktabs = TRUE)

mode3est<-xtable(
  data.frame(
    Variables = c("Intercept","PC1","PC2","age5to14","firearm","nu2","tau2","rho"),
    Median  = c(9.7924,2.6929,-1.1060,0.1941,0.0484,0.0405,0.0692,0.8898),
    "Lower bound" = c(9.6932,2.6621,-1.1748,0.0580,-0.0215,0.0175,0.0283,0.5910),
    "Upper bound"  = c(9.8908,2.7236,-1.0356,0.3323,0.1220,0.0650,0.1365,0.9834)),
  caption = "Estimated parameters of Leroux CAR model",
  digits = c(3,3,3,3,3))

print.xtable(mode3est,table.placement = "H")
```

The first principal component (PC1) is the average suicide age and gender of people older than 15 years old. The coefficient is positive and the 95% confidence interval does not include zero, which means there is a statistical significance increase in the age-standardized suicide rate with the increase of the first principal component. Taking all other variables in the model into account and holding them constant, for one unit increase in the average suicide age and gender of people older than 15 years old, on average, the age-standardized suicide rate will increase 2.7 units in a given country. 

The second principal component (PC2) is the suicide rate difference between older than 70 years old women and aged from 15 to 49 years old men. The coefficient is negative and the 95% confidence interval does not include zero. Hence, there is a statistical significance decrease in the age-standardized suicide with the increasing of the second principal component. Taking all other variables in the model into account and holding them constant, for one unit increase in the second principal component, on average, the age-standardized suicide rate will decrease 1.1 units in a given country. This is because the suicide rate for men is `r round(mean(suicide_2016[,15]),2)` times higher than women. And the fig \ref{fig:PCA2} in section 3.1.3 shows the suicide age of men are younger than women. Therefore, based on the high risk and young age of men, if the suicide rate of men from 15 to 49 years old is high, then this country will tend to have a higher suicide rate than average. 

Similarly, the coefficient for age from 5 to 14 years old (age5to14) is positive and 95% confidence interval does not include zero. Taking all other variables in the model into account and holding them constant, on average, the age-standardized suicide will increase 0.2 unit for every unit increase in children suicide rate.

Unlike other variables, the 95% confidence interval for the suicide rate involving firearms (firearm_rate) includes zero which means the effect of firearm suicide rate is not statistically significant. 

Finally, the point estimate of $\rho$ is 0.8898, suggesting the spatial dependence in these data is very strong.


### Socio-economic model


```{r m2fit}
get_regression_summaries(m2)%>%
  kable(
    digits = 3,
    caption = "Overall fit of multiple regression model",
    booktabs = TRUE)%>%
kable_styling(font_size = 11,latex_options = "HOLD_position",full_width = F)
```

Table \ref{tab:m2fit} shows that the ${R}_{\mbox{adj}}^2$ is only 0.45, indicating the model predictive performance is weak. Therefore, this multiple regression model can only investigate the relationship among these data instead of predicting. In table 7, the estimated parameters of multiple regression model are showed.

```{r m2est}
get_regression_table(m2)%>%
  kable(
    digits = 3,
    caption = "Estimated parameters of multiple regression model",
    booktabs = TRUE)%>%
kable_styling(font_size = 11,latex_options = "HOLD_position",full_width = F)
```

The 95% confidence interval of the first principal component and all three social factors do not include zero and hence they are all statistical significance. However, the 95% confidence interval of both economic factors and the second principal component include zero and hence the effects of these variables are not statistical significance. 

The first principal component (PC1) is the average suicide age and gender of people older than 15 years old. For one unit increase in the first principal component, taking all other variables in the model into account holding them constant, on average, the age-standardized suicide rate will increase `r (round(exp(0.049),2)-1)*100`% ($\mbox{exp}(0.049)=1.05$). 

Taking all other variables in the model into account holding them constant, for one unit increase in the depression rate, on average, the age-standardized suicide rate will increase `r (round(exp(0.337),2)-1)*100`% ($\mbox{exp}(0.337)=1.40$). 

Similarly, taking all other variables in the model into account and holding them constant, on average, the age-standardized suicide rate will increase statistically significant `r (round(exp(0.062),2)-1)*100`% ($\mbox{exp}(0.062)=1.06$) for one unit increase in the alcohol consumption per person in liters of pure alcohol aged older than 15 in a given country. 

Conversely, the age-standardized suicide will decrease `r (round(exp(0.150),2)-1)*100`% ($\mbox{exp}(0.150)=1.16$) for one unit increase in the anxiety disorders rate averagely when taking all other variables in the model into account holding them constant.



# Chapter 4 - Conclusions and discussion

## Conclusions


This work used PCA to explore the suicide age differences between women and men and built two models to investigate how suicide risk factors affect the suicide rate in the world.

From PCA, this work discovered the suicide age for women is older than men as men tend to suicide before the middle age. And the suicide rate for men is `r round(mean(suicide_2016[,15]),2)` times higher than women. Hence, the suicide risk for young men is very high.

The suicide behaviour model presented a spatial pattern in the world as the age and sex structure varies in countries. If the suicide rate of men from 15 to 49 years old is higher than average, then this country will tend to have a higher suicide rate in the world. Although the suicide rate of kids from 5 to 14 years is low, it affects the overall suicide rate statistical significance. However, the firearms rate is not statistical significance. One possible reason for this is people in countries that difficult to access firearms can choose other suicide methods. For example, the `r suicide_2016[which.max(suicide_2016$firearm),]$Entity` has the highest firearm rate which is `r round(suicide_2016[which.max(suicide_2016$firearm),]$firearm)/round(suicide_2016[which.min(suicide_2016$firearm),]$firearm,2)` times higher than the lowest firearm rate country, `r suicide_2016[which.min(suicide_2016$firearm),]$Entity`. The suicide rate in the `r suicide_2016[which.max(suicide_2016$firearm),]$Entity` is only `r round(suicide_2016[suicide_2016$Entity=="United States",]$ASR/suicide_2016[suicide_2016$Entity=="Singapore",]$ASR,2)` times higher than that in `r suicide_2016[which.min(suicide_2016$firearm),]$Entity`. Therefore, to reduce the suicide risk, gun control is not the most effective way. 

The socio-economic model investigated how the social and economic factors affect the suicide rate of people older than 15. The spatial pattern in social and economic factors was absent. And the suicide age difference between women and men became not statistical significance, a possible cause for this is the influence of socio-economic factors is similar between men and women. And the effect of the unemployment rate and GDP per capita are both not statistically significant, suggesting the economic effects are weaker than social effects. For mental illnesses, countries with high depression rates will lead to high suicide risk. However, countries with high anxiety disorders rate tend to have lower suicide rates. Therefore, the government should pay more attention to mental health, especially depression instead of anxiety disorders. Since alcohol consumption is statistical significance, one effective way to reduce the suicide rate is to control alcohol consumption. 

In short, depression and alcohol consumption are high risk for suicide. And the suicide risk of men under the middle age is higher than women. For the government, the effective way to reduce the suicide is offering more help resources of depression and enhance the regulation of alcohol consumption. 

## Discussions

In this work, only 154 countries have been analysed. Due to some countries do not have borders with other countries, the neighbourhood matrix is using an adapted version of the sharing common border approach which is sensitive to the choice of K closest areas and needs to be ensured its symmetry.

In the suicide behavior model, this work only considers the suicide method of firearms. In further analysis, it could add more suicide method variables, such as hanging and drowning. And in the socio-economic model, one of the possible reason for the negative relationship between anxiety disorders and suicide rate is people in developed countries pay more attention to their mental health and seeking for help more easily which reduce the risk of suicide. Therefore, in further analysis, it could add more economic factors into modelling, such as per capita income and Gross national income (GNI). 

\newpage
# Reference
